<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>pbCHARMM.pl - MMTSB</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/mwiki-mmtsb/opensearch_desc.php" title="MMTSB (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://feig.bch.msu.edu/mwiki-mmtsb/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="/mmtsb/pbCHARMM.pl" />
<link rel="alternate" type="application/atom+xml" title="MMTSB Atom feed" href="/mwiki-mmtsb/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="http://feig.bch.msu.edu/mwiki-mmtsb/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.mmtsb.styles&amp;only=styles&amp;skin=mmtsb&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/mwiki-mmtsb/skins/MMTSB/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/mwiki-mmtsb/skins/MMTSB/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: mmtsbwiki:resourceloader:filter:minify-css:7:186aa9ed34970b96f0dd1fdd2e763115 */</style>
<script src="http://feig.bch.msu.edu/mwiki-mmtsb/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=mmtsb&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"pbCHARMM.pl","wgTitle":"pbCHARMM.pl","wgCurRevisionId":114604,"wgRevisionId":114604,"wgArticleId":1375,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"pbCHARMM.pl","wgRelevantArticleId":1375,"wgIsProbablyEditable":false,"wgRestrictionEdit":["sysop"],"wgRestrictionMove":["sysop"]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: mmtsbwiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-pbCHARMM_pl skin-mmtsb action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
			        <TABLE CLASS="header" CELLPADDING=4 WIDTH=100%><TR><TD VALIGN=top>
				<a href="http://mmtsb.chem.lsa.umich.edu"><img src="/mwiki-mmtsb/skins/MMTSB/mmtsblogo-blue.gif" alt="MMTSB" /></a>
				</TD>
				<TD>
				<TABLE CELLPADDING=2 CLASS="header">
				<TR><TD CLASS="toolsettitle" WIDTH=100% ALIGN=right>
				  Tool Set Documentation
		    	        </TD></TR>
				<TR><TD CLASS="searcharea" WIDTH=100% ALIGN=right>
						<div id="p-search" class="portlet" role="search">
			<!--<h3><label for="searchInput">Search</label></h3>-->

			<div id="searchBody" class="pBody">
				<form action="/mwiki-mmtsb/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search MMTSB [f]" accesskey="f" id="searchInput" />
<!--					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />-->
				</form>

							</div>
		</div>
					</TD></TR></TABLE>	
				</TD></TR></TABLE>	

				<div id="navarea">
   						<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<!--<h3>Navigation</h3>-->
		<div class='pBody'>
							<ul>
											<li id="n-Main"><a href="/mmtsb/Main_Page">Main</a></li>
											<li id="n-MMTSB-Research-Resource"><a href="http://www.mmtsb.org" rel="nofollow">MMTSB Research Resource</a></li>
											<li id="n-Forum"><a href="http://www.charmm.org/ubbthreads/postlist.php?Cat=0&amp;Board=MMTSB" rel="nofollow">Forum</a></li>
											<li id="n-Workshops"><a href="http://www.mmtsb.org/workshops.html" rel="nofollow">Workshops</a></li>
											<li id="n-Download"><a href="http://www.mmtsb.org/cgi-bin/download?toolset" rel="nofollow">download</a></li>
											<li id="n-Installation"><a href="/mmtsb/Installation">Installation</a></li>
									</ul>
					</div>
		</div>
					</div>
   		                                      <div id="content">
				
				<a id="top"></a>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">pbCHARMM.pl</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From MMTSB</div>
					<div id="contentSub"></div>
					<!--					-->
					<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><h2><span class="mw-headline" id="Usage">Usage</span></h2>
<pre>usage:   pbCHARMM.pl [options] [PDBfile]
options: [-par param=19|22,hsd=list,hse=list,scalerad,
               smooth,dcel=value,epsp=value,epsw=value,epsr=value,
               pbionconc=value,pbtemp=value,pbionr=value]
         [-psf PSFfile CRDfile]
         [-mol2 MOL2file]
         [-radii file]
         [-partial file] [-threads n]
         [-atomic] [-pairs] [-keepcharge]
         [-log logFile] [-cmd logFile]
         [-custom file]
         [-epsgrid file] [-epssize num]
         [-grid phi|phix|chrg|epsx|epsy|epsz file] [-dx]
         [-emap file]
         [-nocenter]
</pre><A HREF="http://feig.bch.msu.edu/cgi-bin/mmtsb-source?pbCHARMM.pl" TARGET=_new>Show source</A>
<p><br />
</p>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>This script uses the PBEQ module in CHARMM to evaluate the electrostatic
contribution of the solvation free energy by solving the Poisson-Boltzmann
equation. It expects a protein structure in PDB format either from a
file given as the last command line argument or passed through standard input.
Alternatively, CHARMM PSF and coordinate files can be given with <b>-psf</b>
in order to provide the input structure.
The calculated energy value is written to standard output. Please note that
solving the Poisson-Boltzmann equation may be time-demanding and can take
from minutes to hours depending on the size of the molecule and the grid
size chosen.
<br />
</p><p>A number of options can be given in a comma-separated list of key=value
pairs following <b>-par</b>. The force field can be either CHARMM19 (default)
or CHARMM22 and is selected with <b>param=19</b> or <b>param=22</b>,
respectively. Protonation sites for histidine residues may be specified
explicitly by providing the corresponding residue number(s) with <b>hsd</b>
(protonated at ND1) or <b>hse</b> (protonated at NE2).
If the keyword <b>scalerad</b> is given, some of the radii are scaled slightly
so that experimental solvation energies of small molecules are reproduced better.<br />
</p><p>The grid size used in the finite difference
solver can be changed with <b>dcel</b>. The default value is 0.5 &#197;. Good accuracy at the expense of time may be obtained with 0.25 &#197;.
<br />
</p><p>By default, the solvation energy is calculated for a solute with an internal dielectric
of 1 transfered from vacuum (e=1) to water (e=80). The internal (solute) dielectric may be
changed with <b>epsp</b>, the solvent dielectric with <b>epsw</b>, and the reference
dielectric (vacuum by default) with <b>epsr</b>.
<br /><br />
The output from CHARMM can be saved in a file with
the <b>-log</b> option. A CHARMM command file is produced if a file name is
given with <b>-cmd</b>.<br />
</p><p>This script can also be used to calculate standard solvation free energies
for a single charged atom in the context of an otherwise uncharged solute.
This option is selected with <b>-atomic</b>. By default a unity charge is
assumed, but the option <b>-keepcharge</b> can be given to use the force field
charge instead. It is also possible to calculate solvation free energies for
all pairs of charged atoms with <b>-pairs</b> in a similar fashion. Please be
advised that the number of pairs even for small systems becomes quite large and
will require significant time for the Poisson-Boltzmann calculations to complete.
The output contains the Poisson-Boltzmann energy for each atom as well as
the corresponding Generalized Born radius calculated as -166.0/Epb.
Only in this mode the calculation can be distributed over
a number of threads given with <b>-threads</b> if more than one
CPU is available. This form of parallelization works only on SMP (shared memory)
architectures. Parallelization requiring network communication
(through MPI for example) is not supported at this point.
</p>
<h2><span class="mw-headline" id="Options">Options</span></h2>
<dl><dt> -help&#160;</dt>
<dd> usage information</dd>
<dt> -par key=value[,...]&#160;</dt>
<dd> CHARMM parameters</dd>
<dt> -psf PSFfile CRDfile&#160;</dt>
<dd> read topology and initial conformation from CHARMM PSF and CRD files</dd>
<dt> -mol2 MOL2file&#160;</dt>
<dd> read topology and initial conformation from MOL2 file</dd>
<dt> -radii file&#160;</dt>
<dd> read modified van der Waals radii from external file</dd>
<dt> -partial file&#160;</dt>
<dd>&#160;?</dd>
<dt> -threads n&#160;</dt>
<dd> parallelize calculation of atomic solvation free energies on n CPUs/cores</dd>
<dt> -atomic&#160;</dt>
<dd> calculate atomic solvation free energies</dd>
<dt> -pairs&#160;</dt>
<dd> calculate solvation free energies for pairs of atoms</dd>
<dt> -keepcharge&#160;</dt>
<dd> use force field charge instead of unit charge when calculating atomic solvation free energies</dd>
<dt> -log file&#160;</dt>
<dd> output CHARMM log file</dd>
<dt> -cmd file&#160;</dt>
<dd> output CHARMM input file</dd>
<dt> -custom file&#160;</dt>
<dd> provide custom CHARMM commands</dd>
<dt> -epsgrid file&#160;</dt>
<dd> write epsilon distribution</dd>
<dt> -epssize num&#160;</dt>
<dd> size of epsilon grid to be written out</dd>
<dt> -grid phi|phix|chrg|epsx|epsy|epsz file&#160;</dt>
<dd> write grid file</dd>
<dt> -dx&#160;</dt>
<dd> write grid file in DX format</dd>
<dt> -emap file&#160;</dt>
<dd>  write electrostatic potential to file</dd>
<dt> -nocenter&#160;</dt>
<dd> do not center molecule before carrying out PB calculation</dd></dl>
<h2><span class="mw-headline" id="Examples">Examples</span></h2>
<p><tt><FONT COLOR=#702050>pbCHARMM.pl 1vii.exp.min.pdb
</font></tt><br>
calculates the Poisson-Boltzmann electrostatic solvation free energy
<br>
</p>
<pre>-553.329900
</pre>
<p><br />
<tt><FONT COLOR=#702050>pbCHARMM.pl -par dcel=0.4 -log charmm.log 1vii.exp.min.pdb
</font></tt><br>
calculates the Poisson-Boltzmann electrostatic solvation free energy using a (smaller) grid size of 0.4 A. The CHARMM
output is written to <FONT COLOR=#508060>charmm.log</FONT>.
<br>
</p>
<pre>-504.321230
</pre>
<p><br />
<tt><FONT COLOR=#702050>pbCHARMM.pl -par dcel=0.75 -atomic -threads 2 1vii.exp.min.pdb
</font></tt><br>
calculates the standard atomic electrostatic solvation free energies for all atoms in
the given PDB structure. A grid cell size of 0.75 A and two threads are used to 
speed up the calculation.
<br>
</p>
<pre>:1:HT1:1 -151.666690 1.081057
:1:HT2:2 -74.058550 2.213929
:1:N:3 -70.039090 2.340983
:1:HT3:4 -109.583070 1.496220
:1:CA:5 -56.644740 2.894538
:1:CB:6 -60.355740 2.716566
:1:CG:7 -64.488680 2.542467
:1:SD:8 -72.487170 2.261922
:1:CE:9 -74.914680 2.188628
:1:C:10 -57.106690 2.871123

...</pre>
<p><br />
<tt><FONT COLOR=#702050>pbCHARMM.pl -par dcel=0.4,epsp=2,epsw=40 1vii.exp.min.pdb
</font></tt><br>
calculates the transfer energy from vacuum to a medium with a dielectric constant of 40. Also, an internal solute 
dielectric of 2 is used instead of 1.
<br>
</p>
<pre>-379.108250
</pre>

<!-- 
NewPP limit report
CPU time usage: 0.043 seconds
Real time usage: 0.511 seconds
Preprocessor visited node count: 36/1000000
Preprocessor generated node count: 120/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://feig.bch.msu.edu/mwiki-mmtsb/index.php?title=pbCHARMM.pl&amp;oldid=114604">http://feig.bch.msu.edu/mwiki-mmtsb/index.php?title=pbCHARMM.pl&amp;oldid=114604</a>"</div>
					<div id='catlinks' class='catlinks catlinks-allhidden'></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
				</div>
			</div>
		</div>
		
		<div id="editarea">
				<div id="p-cactions" class="portlet" role="navigation">
			<!--<h3>Views</h3>-->

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="/mmtsb/pbCHARMM.pl" title="View the content page [c]" accesskey="c">Documentation</a></li>
				<li id="ca-talk" class="new"><a href="/mwiki-mmtsb/index.php?title=Talk:pbCHARMM.pl&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Comments</a></li>
				<li id="ca-viewsource"><a href="/mwiki-mmtsb/index.php?title=pbCHARMM.pl&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="/mwiki-mmtsb/index.php?title=pbCHARMM.pl&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
			</div>

		<div class="visualClear"></div>
		
	      <TABLE CLASS="footer" CELLSPACING=4 WIDTH=100%>
              <TR><TD CLASS="groups">
              <A HREF="http://brooks.chem.lsa.umich.edu">&nbsp;Brooks group</A><BR>
              <A HREF="http://feig.bch.msu.edu">&nbsp;Feig group</A>
	      </TD>
	      <TD CLASS="pageinfo">
	        <ul>

<!--
					<div id="footer" role="contentinfo">
						<div id="f-poweredbyico">
									<a href="//www.mediawiki.org/"><img src="/mwiki-mmtsb/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/mwiki-mmtsb/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /mwiki-mmtsb/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
							</div>
		</div>		-->
                </ul>
		</TD>
		</TR></TABLE>

		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"ready","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":2015});
}</script></body></html>
